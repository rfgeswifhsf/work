# -*- coding: utf-8 -*-

'''

需要安装 kafka 和 kafka-python 两个包，不然报错
'''
# from kafka import KafkaConsumer
# import  json
import time
from kafka import KafkaProducer
from pprint import pprint
import pandas as pd
producer = KafkaProducer(bootstrap_servers=["10.200.5.117:9092"])

a=[{"relTime":"20191020000000","releaseDate":"2019-10-20","author":"上海发布","isDelete":0,"originalDetailId":69877,"source":"上海发布","title":"为了给上海建言献策,这些国际商业巨头有多拼?有表情包为证!","newsType":"活动资讯","content":"<div class=\"rich_media_content \" id=\"js_content\">\n                    \n\n                    \n\n                    \n                    \n                    <p><img class=\"\" data-ratio=\"0.20125786163522014\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548762993.jpg\" data-type=\"gif\" data-w=\"636\" style=\"\"></p>\n<section data-role=\"outer\" label=\"Powered by 135editor.com\" style=\"font-size:16px;\"><section class=\"_135editor\" data-tools=\"135编辑器\" data-id=\"95209\"><section style=\"padding: 10px;box-sizing: border-box;\"><section style=\"display: flex;justify-content: center;\"><section style=\"width:5px;height:60px;background: #fefefe;transform: rotate(0deg);-webkit-transform: rotate(0deg);-moz-transform: rotate(0deg);-ms-transform: rotate(0deg);-o-transform: rotate(0deg);\"><section style=\"width:5px;\"><img class=\"assistant\" data-ratio=\"11.4\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548763291.jpg\" data-type=\"gif\" data-w=\"10\" data-width=\"100%\" style=\"width: 100%;display: block;\"></section></section><section style=\"width: 4px;background: rgb(203, 203, 239);margin-left: -5px;border-radius: 6px;box-sizing: border-box;\"></section><section data-autoskip=\"1\" class=\"135brush\" style=\"padding: 1em;flex: 1 1 0%;font-size: 14px;letter-spacing: 1.5px;line-height: 1.75em;box-shadow: rgb(235, 235, 235) 1px 1px 6px;box-sizing: border-box;\"><p><span style=\"font-size: 16px;\">第31次上海市市长国际企业家咨询会议马上开始了！这是每年金秋时节在上海滩举行的重量级活动。</span></p>\n<p><br></p>\n<p><span style=\"font-size: 16px;\">今天，年营业收入加起来超过1.5万亿美元的<span style=\"letter-spacing: 1.5px;\">30位</span>国际商业巨头又齐聚黄浦江畔。作为上海市长的顶级顾问，他们将围绕“提升上海城市能级和核心竞争力”的主题为上海提供国际视角。</span></p>\n<p><br></p>\n<p><span style=\"font-size: 16px;\">为了发表真知灼见，他们这一年是怎么过的？跟随\"大咖写论文\"表情包，来了解一下他们对阿拉上海建言献策的过程↓</span></p></section></section></section></section></section><section><section powered-by=\"xiumi.us\"><section><section powered-by=\"xiumi.us\"><section style=\"box-sizing: border-box;font-size: 16px;\"><section style=\"text-align: center;box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"1.9972222\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548763469.jpg\" data-type=\"jpeg\" data-w=\"1080\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section><section style=\"text-align: center;box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"0.5227975\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548763907.jpg\" data-type=\"gif\" data-w=\"2588\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section><section style=\"text-align: center;box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"1.0472222\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548764391.jpg\" data-type=\"jpeg\" data-w=\"1080\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section><section style=\"text-align: center;box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"0.5227975\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548764578.jpg\" data-type=\"gif\" data-w=\"2588\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section><section style=\"text-align: center;box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"0.6305556\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548764783.jpg\" data-type=\"jpeg\" data-w=\"1080\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section><section style=\"box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"text-align: center;box-sizing: border-box;\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"0.5227975\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548765096.jpg\" data-type=\"gif\" data-w=\"2588\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section></section><section style=\"box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"text-align: center;box-sizing: border-box;\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"0.5935185\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548765429.jpg\" data-type=\"jpeg\" data-w=\"1080\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section></section><section style=\"text-align: center;box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"0.5227975\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548765891.jpg\" data-type=\"gif\" data-w=\"2588\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section><p style=\"text-align: center;\"><img class=\"rich_pages\" data-ratio=\"1.1101851851851852\" data-s=\"300,640\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548766122.jpg\" data-type=\"jpeg\" data-w=\"1080\" style=\"\"></p>\n<section style=\"text-align: center;box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"0.5227975\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548766511.jpg\" data-type=\"gif\" data-w=\"2588\" style=\"vertical-align: middle;box-sizing: border-box;\"></section><br></section><section style=\"text-align: center;box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"0.9740741\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548766670.jpg\" data-type=\"jpeg\" data-w=\"1080\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section><section style=\"text-align: center;box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"0.5227975\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548766959.jpg\" data-type=\"gif\" data-w=\"2588\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section><section style=\"text-align: center;box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"0.4944444\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548767234.jpg\" data-type=\"jpeg\" data-w=\"1080\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section><section style=\"text-align: center;box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-cropselx1=\"0\" data-cropselx2=\"574\" data-cropsely1=\"0\" data-cropsely2=\"260\" data-ratio=\"0.453125\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548767488.jpg\" data-type=\"jpeg\" data-w=\"1280\" style=\"vertical-align: middle;box-sizing: border-box;width: 574px;height: 260px;\"></section></section><section style=\"text-align: center;box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"0.5227975\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548767634.jpg\" data-type=\"gif\" data-w=\"2588\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section><section style=\"text-align: center;box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-cropselx1=\"0\" data-cropselx2=\"574\" data-cropsely1=\"0\" data-cropsely2=\"683\" data-ratio=\"0.61796875\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548767922.jpg\" data-type=\"jpeg\" data-w=\"1280\" style=\"vertical-align: middle;box-sizing: border-box;width: 574px;height: 355px;\"></section></section><section style=\"text-align: center;box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"0.5227975\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548768592.jpg\" data-type=\"gif\" data-w=\"2588\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section><section style=\"text-align: center;box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"1.1157407\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548768839.jpg\" data-type=\"jpeg\" data-w=\"1080\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section><section style=\"text-align: center;box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"0.5227975\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548769100.jpg\" data-type=\"gif\" data-w=\"2588\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section><section style=\"box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"text-align: center;box-sizing: border-box;\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"0.4296296\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548769333.jpg\" data-type=\"jpeg\" data-w=\"1080\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section></section><section style=\"text-align: center;box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"0.5227975\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548769685.jpg\" data-type=\"gif\" data-w=\"2588\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section></section></section><section style=\"box-sizing: border-box;\" powered-by=\"xiumi.us\"><section style=\"text-align: center;box-sizing: border-box;\"><section style=\"max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;\"><img class=\"raw-image\" data-ratio=\"1\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548770113.jpg\" data-type=\"gif\" data-w=\"240\" style=\"vertical-align: middle;box-sizing: border-box;\"></section></section></section></section></section><section class=\"horizontal-tb\" style=\"box-sizing: border-box;\" powered-by=\"xiumi.us\"><section data-role=\"outer\" label=\"Powered by 135editor.com\" style=\"font-size:16px;\"><section class=\"_135editor\" data-tools=\"135编辑器\" data-id=\"94729\"><section style=\"text-align: center;\"><section style=\"display: inline-block;background: rgb(255, 243, 224);color: rgb(238, 180, 94);border-radius: 8px;padding: 5px 10px;box-sizing: border-box;\"><section style=\"display: flex;justify-content: center;align-items:center;\"><section style=\"width:1em;\"><img class=\"assistant\" data-ratio=\"0.41025641025641024\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548770317.jpg\" data-type=\"png\" data-w=\"39\" data-width=\"100%\" style=\"width: 100%;display:block;transform: scaleX(-1);-webkit-transform: scaleX(-1);-moz-transform: scaleX(-1);-ms-transform: scaleX(-1);-o-transform: scaleX(-1);\"></section><section style=\"padding-right: 0.5em;padding-left: 0.5em;letter-spacing: 1.5px;box-sizing: border-box;\" class=\"135brush\" data-brushtype=\"text\"><span style=\"font-size: 14px;color: rgb(227, 108, 9);\">微信后台回复“<strong>2019市咨会</strong>”下载“大咖写论文”相关表情包，长按即可保存到手机或发送给好友~</span></section><section style=\"width:1em;\"><img class=\"assistant\" data-ratio=\"0.41025641025641024\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548770317.jpg\" data-type=\"png\" data-w=\"39\" data-width=\"100%\" style=\"width: 100%;display: block;\"></section></section></section></section></section><section data-role=\"paragraph\" class=\"_135editor\"><p><br></p></section></section></section></section><p><span style=\"font-size: 16px;color: rgb(136, 136, 136);\">资料：</span><span style=\"font-size: 16px;color: rgb(136, 136, 136);\">市外办</span></p>\n<p><span style=\"font-size: 16px;color: rgb(136, 136, 136);\">漫画：</span><span style=\"font-size: 16px;color: rgb(136, 136, 136);\">三姐工作室</span><br></p>\n<p><span style=\"font-size: 16px;color: rgb(136, 136, 136);\">编辑：</span><span style=\"font-size: 16px;color: rgb(136, 136, 136);\">景雯</span><span style=\"font-size: 16px;color: rgb(136, 136, 136);\"></span><br></p>\n<p><img class=\"\" data-ratio=\"0.594\" src=\"https://pics.lvjs.com.cn/uploads/pc/place2/information/2019-06-28/information_1571548771336.jpg\" data-type=\"gif\" data-w=\"500\" style=\"\"></p>\n                </div>","authorIconUrl":"","url":"https://mp.weixin.qq.com/s?src=11&timestamp=1571547626&ver=1923&signature=AwocFLTC0QdeoBBzGhUitYXbgYg*wGetLcpUfvyuhPSk9LjdkKjvaPXNvGzhvRDmObDWYAr8v9DVyFb1DHosBPDGh1IBfkGPlNQ3a6fjhnbvaTuyAvDQIq8gCW6vOeN-&new=1","urlListId":70769,"createTime":"20191020132049","clickNumber":0,"id":58338,"category":14},
]

i = 0
while i<len(a)-1:
    i+=1
    msg =pd.DataFrame([a[i]]
,columns=["releaseTime","releaseDate","author","isDelete",
           "originalDetailId","source","title","newsType",
           "content","authorIconUrl","url"]).to_json(orient="records",force_ascii=False)[1:-1]
    print("beigin...")
    producer.send('zhangwei123',partition=0, value=msg.encode('utf-8'))
    print(msg)
    time.sleep(5)
producer.close()

